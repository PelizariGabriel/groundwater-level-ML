# ğŸ“˜ Groundwater Level Analysis & Forecasting  
### Hydrogeological EDA + 3-Layer LSTM Forecasting

This repository contains a complete workflow for analyzing and forecasting groundwater levels in an aquifer using environmental, hydrometeorological, pumping, atmospheric pressure, and solid Earth tide datasets.

The project is composed of two main notebooks:

1. **Hydrogeological EDA â€“ Aquifer Water Level Analysis**  
2. **Groundwater Level Forecasting â€“ 3-Layer LSTM**

Both notebooks use the same integrated dataset and support a consistent user-selected time window.

---

# ğŸ“‚ Data Overview

All datasets must be located inside the **`data/`** directory:
```md
project/
â””â”€â”€ data/
â”œâ”€â”€ nivel-pocos_chuva_pressao_tratados.csv
â”œâ”€â”€ funcionamento_pocos_30min.csv
â”œâ”€â”€ earth_tide.csv
```

Each dataset is described below.

---

## ğŸŸ¦ 1. Groundwater Levels, Rainfall & Barometric Pressure  
**File:** `nivel-pocos_chuva_pressao_tratados.csv`

### Origin
This dataset is generated by a preprocessing workflow that merges:

- Raw piezometer readings (absolute pressure transducers)  
- Atmospheric pressure (barometric IG + MERRA2-derived corrections)  
- Rainfall measurements (30-min resolution)  

The output contains cleaned and barometrically compensated water levels ready for modeling.

### Main Columns

| Column | Meaning |
|--------|---------|
| `date_time` | Timestamp (30-min resolution) |
| `pressao_mH2O_final` | Final atmospheric pressure (IG + MERRA2 resampled to 30 min) |
| `gmu_level_mH2O_compensado` | GMU well compensated water level |
| `chuva_mm_30min` | Total rainfall during the 30-min interval |

### Scientific Context
Absolute pressure transducers record:

Water Level = Total Pressure - Atmospheric Pressure

Thus, accurate barometric compensation is essential before any hydrogeological analysis or ML forecasting.

---

## ğŸŸ© 2. Pumping Well Operational Status  
**File:** `funcionamento_pocos_30min.csv`

### Origin
Derived from Unicamp's telemetry logs and resampled to uniform 30-minute intervals.

### Columns

| Column | Meaning |
|--------|---------|
| `date_time` | Timestamp |
| `status_IMECC` | Pumping activity of IMECC (1 = on, 0 = off) |
| `status_FEF` | Pumping activity of FEF (1 = on, 0 = off) |
| `status_ZOOLOGIA` | Pumping activity of Zoologia (1 = on, 0 = off) |

### Context
Pumping regimes directly influence groundwater levels (drawdowns, recovery, transient behavior).  
Including these variables allows the models to distinguish hydrogeological responses from operational effects.

---

## ğŸŸ« 3. Solid Earth Tide  
**File:** `earth_tide.csv`

### Origin
Generated using TSoft geophysical modeling, which computes vertical crustal deformation due to lunar and solar gravitational forces, for the coordinates of the GrÃ¡fica well (30-min resolution).

### Columns

| Column | Meaning |
|--------|---------|
| `date_time` | Timestamp |
| `earth_tide_nm/s2` | Vertical gravitational tidal component |

### Context
Earth tides can introduce subtle oscillations in groundwater levels and may improve short-term forecasting accuracy when included as a feature.

---

# ğŸ”— Data Integration Pipeline

Both notebooks first merge three datasets:

- `nivel-pocos_chuva_pressao_tratados.csv`  
- `funcionamento_pocos_30min.csv`  
- `earth_tide.csv`

using an **outer join on `date_time`**, creating an integrated dataset with:

- Water levels (raw + compensated)  
- Rainfall  
- Barometric pressure  
- Pumping well operational states  
- Earth tide signal  

The merged data is then filtered by a user-defined study period (e.g., Mayâ€“July 2022).

---

# ğŸ“˜ Notebook 1 â€“ Hydrogeological EDA

This notebook performs an extensive exploratory analysis:

### âœ”ï¸ Data Quality
- Missing values, duplicates  
- Time gap detection (30-min sampling validation)  

### âœ”ï¸ Statistics & Distributions
- Descriptive statistics  
- Skewness, kurtosis  
- Outlier detection (z-score)  

### âœ”ï¸ Time Series Characteristics
- Trend & seasonal decomposition (STL)  
- ACF / PACF  
- Correlation analysis (heatmaps)  

### âœ”ï¸ Hydrogeological Mechanisms
- Rainfall â†’ recharge response  
- Barometric pressure â†’ water level response  
- Pumping effects â†’ drawdown quantification  
- Earth tide influence  

This supports a deeper understanding of aquifer behavior before ML modeling.

---

# ğŸ¤– Notebook 2 â€“ Groundwater Level Forecasting (LSTM)

This notebook implements a 3-layer LSTM for short-term water level prediction.

### âœ”ï¸ Workflow
- Time-window selection  
- Feature engineering:
  - Lag features  
  - Rainfall accumulations  
  - Weekday flags  
  - Earth tide signal  
- Scaling (MinMaxScaler)  
- Sliding-window LSTM sequence generation  
- Train/Validation/Test split  
- Grid search over key LSTM hyperparameters  
- Final model training  
- Model evaluation (RÂ², RMSE, MAE, NSE)  
- Prediction vs observation visualization  
- Permutation Feature Importance  
- SHAP interpretability  

---

# ğŸ—‚ Recommended Project Structure
```md 
project/
â”‚
â”œâ”€â”€ data/
â”‚ â”œâ”€â”€ nivel-pocos_chuva_pressao_tratados.csv
â”‚ â”œâ”€â”€ funcionamento_pocos_30min.csv
â”‚ â”œâ”€â”€ earth_tide.csv
â”‚
â”œâ”€â”€ EDA_hydrogeology.ipynb
â”œâ”€â”€ LSTM_forecasting.ipynb
â”‚
â””â”€â”€ README.md

```
---

# ğŸŒ Scientific Context

This directory is part of a master's research project at **Unicamp**, focused on applying **Machine Learning** to hydrogeology in order to:

- Understand aquifer behavior  
- Quantify how rainfall, barometric pressure, Earth tides, and pumping influence groundwater levels  
- Develop robust ML models to forecast groundwater availability  
- Use explainable AI (SHAP, permutation importance) to link ML behavior to real hydrogeological mechanisms  

---

# ğŸ“« Project Responsible & Contact

This project is fully developed and maintained by **Gabriel Pelizari**.

For questions, collaboration, or academic discussion:

- **Email:** pelizari.gabriel00@gmail.com  
- **LinkedIn:** https://www.linkedin.com/in/gabriel-pelizari-661286145/  
- **GitHub:** https://github.com/PelizariGabriel 
